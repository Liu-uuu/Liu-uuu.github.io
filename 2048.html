<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1" />
	<title>移动端--2048ForYou</title>
	<script>
		var thisHtml=document.getElementsByTagName('html');
		var deviceW=document.documentElement.clientWidth;
		thisHtml[0].style.fontSize=deviceW/3.75+"px";
	</script>
	<style type="text/css">
		body{
			background: pink;
		}
		#container{
			width: 3.60rem;
			height: 3.60rem;
			border: 0.01rem solid #26382C;
			border-radius: 5%;
			background: #26382C;
			margin: 0 auto;
			/*overflow: hidden;*/
			position: relative;
		}
		#container div{
			width: 0.80rem;
			height: 0.80rem;
			border: 0.01rem solid #D61352;
			border-radius: 20%;
			background: #D61352;
			font:0.40rem/0.80rem '微软雅黑';
			font-weight: bold;
			color: #A7D0B1;
			text-align: center;
			position: absolute;
		}
		input{

			/*margin: 0;*/
			padding:0 0.02rem;
		}

	</style>
</head>

<body>
	<div id="container"></div>
	<input type="button" value="左">
	<input type="button" value="右">
	<input type="button" value="上">
	<input type="button" value="下">
	<input type="button" value="生成">

	<script type="text/javascript">
		// alert('还未完成 敬请期待')

		var container=document.getElementById('container');	
		/*---------------------------------------------------*/	
		//生成结构
		var box='';
		for (var i = 0; i < 16; i++) {
			box+='<div>'+i+'</div>'
		}
		container.innerHTML+=box;


		/*---------------------------------------------------*/	
		//参数初始化
		var nums=container.getElementsByTagName('div');
		for (var i = 0; i < nums.length; i++) {
			nums[i].title=i;
			nums[i].value=0;
			nums[i].innerHTML='';
		}


		/*---------------------------------------------------*/	
		//初始化定位		
		for (var i = 0; i < nums.length; i++) {
			nums[i].style.left=0.04+nums[i].title%4*0.9+'rem'
			nums[i].style.top=0.04+Math.floor(nums[i].title/4)*0.9+'rem';
		}	


		/*---------------------------------------------------*/	
		//初始生成2个数字2
		randomInner();
		randomInner();

		//随机位置的空白格生成数字2
		function randomInner(){
			var ranNum=Math.floor(Math.random()*16);
			if (nums[ranNum].innerHTML=='') {
				nums[ranNum].value=2;
				nums[ranNum].innerHTML=2;
			}else{
				var nextRanNum=false;
				for (var i = 0; i < 16; i++) {
					if (nums[i].innerHTML=='') {
						nextRanNum=true;
						break;
					}
				}
				if (nextRanNum) {
					randomInner()
				}					
			}
		}


		/*---------------------------------------------------*/	
		//定义二维数组记录坐标		
		var posArr=[ [] , [] , [] , [] ];
		//各个元素装进数组
		for (var i = 0; i < nums.length; i++) {		
			posArr[Math.floor(nums[i].title/4)].push(nums[i]);		
		}
		// console.dir(posArr)


/*--------------------------------------------------------------------------------------*/	
		/*---------------------------------------------------*/	
		//数组左排序：无内容在后
		// sortArrL(posArr);
		function sortArrL(arr){
			// alert(arr[0])
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value!=0){
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value==0){
						// alert(0)
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				arr[i].splice(0,4);	
			}
		}


		/*---------------------------------------------------*/	
		//数组右排序：无内容在前
		// sortArrL(posArr);
		function sortArrR(arr){
			// alert(arr[0])
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value==0){
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value!=0){
						// alert(0)
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				arr[i].splice(0,4);	
			}
		}


		/*---------------------------------------------------*/	
		//横向相邻数字相等抵消
		function sameNumX(arr){
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if (arr[i][j+1]) {
						if(arr[i][j].value==arr[i][j+1].value){
							arr[i][j].value=arr[i][j].value*2;
							if (arr[i][j].value!=0) {
								arr[i][j].innerHTML=arr[i][j].value;
							}							
							arr[i][j+1].value=0;
							arr[i][j+1].innerHTML='';	
						}
					}
				}
			}
		}
		/*---------------------------------------------------*/	


/*--------------------------------------------------------------------------------------*/


		/*---------------------------------------------------*/	
		//数组纵向（Y轴）排序（无内容在后）
		// sortArrY(posArr);
		function sortArrY(arr){
			arr.push(arr)
			var arrIndex=4;
			for (var i = 0; i < 4; i++) {

				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value!=0){
						arr[arrIndex][j].value=arr[i][j].value;
						arrIndex++;	
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j]==0){
						arr[arrIndex][j].value=arr[i][j].value
						arrIndex++;	
					}
				}
			}
				
			arr.splice(0,4);
		}

		/*---------------------------------------------------*/	
		//纵向相邻数字相等抵消
		function sameNumY(){
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value==arr[i+1][j].value){
						arr[i][j].value*=2;
						arr[i+1][j].value=0;
						arr[i+1][j].innerHTML='';
					}
				}
			}
		}




		//辅助区
		/*---------------------------------------------------*/	

		var btn=document.getElementsByTagName('input');
		btn[4].onclick=randomInner;

		btn[0].onclick=function(){
			sortArrL(posArr);
			sameNumX(posArr);
			sortArrL(posArr);

			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					posArr[i][j].style.left=0.04+j*0.9+'rem'
					posArr[i][j].style.top=0.04+i*0.9+'rem'
				}
			}
			randomInner();
		}
		btn[1].onclick=function(){
			sortArrR(posArr);
			sameNumX(posArr);
			sortArrR(posArr);

			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					posArr[i][j].style.left=0.04+j*0.9+'rem'
					posArr[i][j].style.top=0.04+i*0.9+'rem'
				}
			}
			randomInner();
		}

		// btn[2].onclick=function(){
		// 	sortArrY(posArr);
		// 	sameNumX(posArr);
		// 	sortArrY(posArr);

		// 	for (var i = 0; i < 4; i++) {
		// 		for (var j = 0; j < 4; j++) {
		// 			posArr[i][j].style.left=0.04+j*0.9+'rem'
		// 			posArr[i][j].style.top=0.04+i*0.9+'rem'
		// 		}
		// 	}
		// 	randomInner();
		// }


	</script>
</body>

</html>