<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1" />
	<title>移动端--2048ForYou</title>
	<script>
		var thisHtml=document.getElementsByTagName('html');
		var deviceW=document.documentElement.clientWidth;
		thisHtml[0].style.fontSize=deviceW/3.75+"px";
	</script>
	<style type="text/css">
		body{
			background: pink;
		}
		#container{
			width: 3.60rem;
			height: 3.60rem;
			border: 0.01rem solid #26382C;
			border-radius: 5%;
			background: #26382C;
			margin: 0 auto;
			/*overflow: hidden;*/
			position: relative;
		}
		#container div{
			width: 0.80rem;
			height: 0.80rem;
			border: 0.01rem solid #D61352;
			border-radius: 20%;
			background: #D61352;
			font:0.40rem/0.80rem '微软雅黑';
			font-weight: bold;
			color: #A7D0B1;
			text-align: center;
			position: absolute;
			font-size: 20px;
		}
		input{

			/*margin: 0;*/
			padding:0 0.02rem;
		}

	</style>
</head>

<body>
	<div id="container"></div>
	<input type="button" value="左">
	<input type="button" value="右">
	<input type="button" value="上">
	<input type="button" value="下">
	<input type="button" value="生成">

	<script type="text/javascript">
		
/*--------------------------------------------------------------------------------------*/	
/*--------------------------------------------------------------------------------------*/	
		// alert('还未完成 敬请期待')
		var container=document.getElementById('container');	
		/*---------------------------------------------------*/	
		//生成结构
		var box='';
		for (var i = 0; i < 16; i++) {
			box+='<div>'+i+'</div>'
		}
		container.innerHTML+=box;


		/*---------------------------------------------------*/	
		//参数初始化
		var nums=container.getElementsByTagName('div'); //获取
		for (var i = 0; i < nums.length; i++) {			//属性设置
			nums[i].id='id'+i;
			nums[i].title=i;
			nums[i].value=0;
			nums[i].innerHTML=nums[i].id;
		}		
		var posArr=[ [] , [] , [] , [] ];				//二维数组容器
		for (var i = 0; i < nums.length; i++) {			//初始数组
			posArr[Math.floor(nums[i].title/4)].push(nums[i]);		
		}		
		divPos()										//初始定位
		// //初始化定位		
		// for (var i = 0; i < nums.length; i++) {
		// 	nums[i].style.left=0.04+nums[i].title%4*0.9+'rem'
		// 	nums[i].style.top=0.04+Math.floor(nums[i].title/4)*0.9+'rem';
		// }
		randomInner();									//初始生成2次数字2
		randomInner();

/*--------------------------------------------------------------------------------------*/	
/*--------------------------------------------------------------------------------------*/	

		//根据数组id属性获取div
		function getDiv(divId){
			return document.getElementById(divId)
		}


		/*---------------------------------------------------*/
		//定位
		function divPos(){
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					posArr[i][j].style.left=0.04+j*0.9+'rem'
					posArr[i][j].style.top=0.04+i*0.9+'rem'
				}
			}
		}

	
		/*---------------------------------------------------*/	
		//随机位置的空白格生成数字2
		function randomInner(){
			var ranNum=Math.floor(Math.random()*16);
			if (nums[ranNum].value==0) {
				nums[ranNum].value=2;
				nums[ranNum].innerHTML=2+nums[ranNum].id;
			}else{
				var nextRanNum=false;
				for (var i = 0; i < 16; i++) {
					if (nums[i].value==0) {
						nextRanNum=true;
						break;
					}
				}
				if (nextRanNum) {
					randomInner()
				}					
			}
		}

/*--------------------------------------------------------------------------------------*/	
/*--------------------------------------------------------------------------------------*/	

		//数组左排序：无内容在后
		// sortArrL(posArr);
		function sortArrL(arr){
			// alert(arr[0])
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value!=0){
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value==0){
						// alert(0)
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				arr[i].splice(0,4);	
			}
		}


		/*---------------------------------------------------*/	
		//数组右排序：无内容在前
		// sortArrL(posArr);
		function sortArrR(arr){
			// alert(arr[0])
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value==0){
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if(arr[i][j].value!=0){
						// alert(0)
						arr[i].push(arr[i][j])
					}
				}
			}
			for (var i = 0; i < 4; i++) {
				arr[i].splice(0,4);	
			}
		}


		/*---------------------------------------------------*/	
		//横向相邻数字相等抵消
		function sameNumX(arr){
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if (arr[i][j+1]) {
						if(arr[i][j].value==arr[i][j+1].value){
							arr[i][j].value=arr[i][j].value*2;
							if (arr[i][j].value!=0) {
								arr[i][j].innerHTML=arr[i][j].value+arr[i][j].id;
							}							
							arr[i][j+1].value=0;
							arr[i][j+1].innerHTML=arr[i][j+1].id;	
						}
					}
				}
			}
		}


		/*-----------------------------------------------------------*/
		/*-----------------------------------------------------------*/


		//数组纵向（Y轴）排序（无内容在后）
		// sortArrY(posArr);
		function sortArrT(arr){
			

			var newarr=arr;
			console.dir(newarr)

			var mi=0;
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {

					if (arr[i][j].value!=0) {
						newarr[mi][j]=arr[i][j];
					}
					
				}
			}


			
		}

		/*---------------------------------------------------*/	
		//纵向相邻数字相等抵消

		function sameNumY(arr){
			for (var i = 0; i < 4; i++) {
				for (var j = 0; j < 4; j++) {
					if (arr[i+1][j]) {
						if(arr[i][j].value==arr[i+1][j].value){
							arr[i][j].value=arr[i][j].value*2;
							if (arr[i][j].value!=0) {
								arr[i][j].innerHTML=arr[i][j].value;
							}	
							arr[i+1][j].value=0;
							arr[i+1][j].innerHTML='';	
						}
					}		
				}
			}
		}

/*--------------------------------------------------------------------------------------*/	
/*--------------------------------------------------------------------------------------*/	

		var btn=document.getElementsByTagName('input');
		btn[4].onclick=randomInner;

		btn[0].onclick=function(){
			sortArrL(posArr);
			sameNumX(posArr);
			sortArrL(posArr);

			divPos()		//定位
			randomInner();	//生成数字2
		}
		btn[1].onclick=function(){
			sortArrR(posArr);
			console.dir(posArr)
			// sameNumX(posArr);
			// sortArrR(posArr);

			divPos()		//定位
			// randomInner();	//生成数字2
		}

		btn[2].onclick=function(){
			sortArrT(posArr);
			// sameNumY(posArr);
			// sortArrT(posArr);

			// divPos()		//定位
			// randomInner();	//生成数字2
		}

	
	</script>
</body>

</html>